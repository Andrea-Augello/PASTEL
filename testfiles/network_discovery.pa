device root=127.0.0.1:1234;

def find_neighbours(node){
		string message="Neighbours_list reply"+NL;

		print(node);
		list known_nodes = [ node ];

		console(node);
		connect(node);

		if(isConnected(node)==FALSE){
			quit("Cannot connect to root at "+root);
		}
		send(node,message);
		string reply=receive(node);
		list neighbours = split(reply,","); //expected CSV
		int i=0;
		while(i<length(neighbours)){
			neighbours[i]=s2d(strip(neighbours[i]));
			i=i+1;
		}
		disconnect(node);

		known_nodes = known_nodes + neighbours;
		print(known_nodes);
}

find_neighbours(root);
